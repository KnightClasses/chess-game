<h1 class="game-name"><%= @game.name %></h1>

<div class='board'>
  <%# establishes the vertical dimension of the board %>
  <% 8.downto(1) do |y| %>
    <div class='row'>
    <%# establishes the horizontal dimension of the board %>
    <% 1.upto(8) do |x| %>
      <%# on odd numbered rows, alternate between white and black, starting with white %>
      <% if y % 2 == 1 %>
        <% if x % 2 == 0 %>
          <% cell_color = "white" %>
        <% else %>
          <% cell_color = "grey" %>
        <% end %>
      <% else %>
        <%# on even numbered rows, alternate between white and black, starting with black %>
        <% if x % 2 == 0 %>
          <% cell_color = "grey" %>
        <% else %>
          <% cell_color = "white" %>
        <% end %>
      <% end %>

      <% piece = @game.pieces.find_by(x: x, y: y) %>
      <% if piece.present? %>
        <%# if piece present at x-y, create: cell color/id div, div link and piece image %>
        <%= link_to game_piece_path(@piece, piece: { x: x, y: y }), method: "patch" do %>
          <div class=<%= cell_color %> id=<%= "#{x}-#{y}" %>>
            <div class="pieces">
              <% piece_color = piece.color.downcase %>
              <% piece_type = piece.type.downcase %>
              <%= image_tag("#{piece_color}_#{piece_type}", height: '90', width: '90') %>
            </div>
          </div>
        <% end %>
      <% else %>
        <%# if piece not present at x-y, create: cell color/id div and div link %>
        <%= link_to game_piece_path(@piece, piece: { x: x, y: y }), method: "patch" do %>
          <div class=<%= cell_color %> id=<%= "#{x}-#{y}" %>></div>
        <% end %>
      <% end %>

    <% end %>
    </div>
  <% end %>
</div>

<script>
  var x = <%= @piece.x %>
  var y = <%= @piece.y %>
  var xy = x + '-' + y
  var pieceXY = $('#' + xy);
  $( "div" ).find( pieceXY ).css( "border", "red solid 5px" );
</script>
